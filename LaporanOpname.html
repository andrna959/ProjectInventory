<div class="d-flex justify-content-between align-items-center mb-4 fade-in">
  <h3 class="fw-bold text-primary">Laporan Opname</h3>
  <button class="btn btn-success" onclick="exportExcel()">
    <i class="material-icons" style="vertical-align:bottom">file_download</i> Export Excel
  </button>
</div>

<div class="card border-0 shadow-sm p-4 fade-in">
  <p class="text-muted">Menampilkan riwayat aktivitas stok opname (cek fisik) barang.</p>
  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead class="table-light">
        <tr><th>ID</th><th>Tanggal</th><th>Kode</th><th>Nama</th><th>Sistem</th><th>Fisik</th><th>Selisih</th><th>Petugas</th></tr>
      </thead>
      <tbody id="lo_table"><tr><td colspan="8">Loading...</td></tr></tbody>
    </table>
  </div>
</div>

<script>
  (function() {
    google.script.run.withSuccessHandler(res => {
      var html = '';
      res.data.forEach(r => {
        html += `<tr><td><small>${r[0]}</small></td><td>${r[1]}</td><td>${r[2]}</td><td>${r[3]}</td><td>${r[4]}</td><td>${r[5]}</td><td class="${r[6]!=0?'text-danger fw-bold':'text-success'}">${r[6]}</td><td>${r[8]}</td></tr>`;
      });
      document.getElementById('lo_table').innerHTML = html || '<tr><td colspan="8" class="text-center">Belum ada data</td></tr>';
    }).getDataOpname(1, 50);
  })();

  function exportExcel() {
    Swal.fire('Info', 'Fitur Export akan men-download file CSV.', 'info');
  }
</script>
